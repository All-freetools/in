<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Indian ID Card Maker</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
    /* --- Theme: Indian Government / Official Style --- */
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Poppins', sans-serif; }
    
    body {
        background-color: #f3f4f6;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
    }

    /* --- Blinking Home Button --- */
    .back-home-btn {
        position: fixed; bottom: 20px; right: 20px; z-index: 9999;
        background: #111; color: white; text-decoration: none;
        padding: 12px 20px; border-radius: 50px; font-weight: bold;
        display: flex; align-items: center; gap: 8px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3); border: 2px solid white;
        animation: pulse-glow 2s infinite;
    }
    @keyframes pulse-glow {
        0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); transform: scale(1); }
    }

    .container {
        width: 100%; max-width: 900px;
        background: white; border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        overflow: hidden;
        display: flex; flex-direction: column;
    }

    /* Header with Tricolor hint */
    .header {
        background: linear-gradient(135deg, #ff9933 0%, #ffffff 50%, #138808 100%);
        padding: 30px; text-align: center;
        border-bottom: 4px solid #000080; /* Navy Blue */
    }
    .header h2 { 
        color: #000080; font-weight: 800; font-size: 28px; text-transform: uppercase; 
        background: rgba(255,255,255,0.8); display: inline-block; padding: 5px 15px; border-radius: 5px;
    }
    .header p { color: #333; font-weight: 600; margin-top: 5px; font-size: 14px; }

    /* Layout: Controls vs Preview */
    .workspace {
        display: flex; flex-wrap: wrap; padding: 30px; gap: 30px;
    }
    .controls { flex: 1; min-width: 300px; }
    .preview-area { 
        flex: 1; min-width: 300px; 
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        background: #e2e8f0; border-radius: 15px; padding: 20px;
        border: 2px dashed #cbd5e1;
    }

    /* Input Groups */
    .control-group { margin-bottom: 20px; }
    .label { font-size: 13px; font-weight: 700; color: #475569; margin-bottom: 8px; display: block; }
    
    select, input[type="file"] {
        width: 100%; padding: 12px; border: 2px solid #cbd5e1;
        border-radius: 10px; font-size: 15px; outline: none; transition: 0.3s;
    }
    select:focus { border-color: #ff9933; }

    /* Range Sliders */
    .slider-row { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
    .slider-row i { width: 20px; color: #64748b; }
    input[type=range] { flex: 1; accent-color: #000080; cursor: pointer; }

    /* Buttons */
    .btn-action {
        width: 100%; padding: 15px; border: none; border-radius: 10px;
        font-size: 16px; font-weight: 700; cursor: pointer; transition: 0.3s;
        display: flex; align-items: center; justify-content: center; gap: 10px;
        margin-top: 10px;
    }
    .btn-download { background: #000080; color: white; } /* Navy */
    .btn-download:hover { background: #1a1a9f; box-shadow: 0 5px 15px rgba(0,0,128,0.3); }
    
    .btn-print { background: #138808; color: white; } /* Green */
    .btn-print:hover { background: #1b9e0f; }

    /* Canvas (Hidden, used for processing) */
    canvas { display: none; }

    /* Live Image Preview */
    #liveImg {
        max-width: 100%;
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        border: 1px solid #ccc;
        transition: filter 0.2s;
    }
    
    .dimensions-badge {
        margin-top: 15px; font-size: 12px; color: #64748b; background: white;
        padding: 5px 10px; border-radius: 20px; font-weight: 600;
    }

</style>
</head>
<body>

<a href="index.html" class="back-home-btn">
    <i class="fa-solid fa-house"></i> GO HOME
</a>

<div class="container">
    <div class="header">
        <h2>Indian ID Card Maker</h2>
        <p>Official CR80 Size Resizer & Printer (300 DPI)</p>
    </div>

    <div class="workspace">
        
        <div class="controls">
            
            <div class="control-group">
                <span class="label">1. Select Card Type</span>
                <select id="cardType" onchange="updateSettings()">
                    <option value="aadhar">Aadhar Card (PVC Size)</option>
                    <option value="pan">PAN Card</option>
                    <option value="voter">Voter ID (New)</option>
                    <option value="dl">Driving License</option>
                    <option value="ayushman">Ayushman Bharat (Health)</option>
                    <option value="pmkisan">PM Kisan Card</option>
                    <option value="pran">PRAN Card (NPS)</option>
                    <option value="school">School/College ID (Standard)</option>
                    <option value="custom">Custom Size (CR80)</option>
                </select>
            </div>

            <div class="control-group">
                <span class="label">2. Upload Card Image (Front or Back)</span>
                <input type="file" id="fileInput" accept="image/*">
            </div>

            <div class="control-group">
                <span class="label">3. Enhance Quality</span>
                
                <div class="slider-row">
                    <i class="fa-solid fa-sun" title="Brightness"></i>
                    <input type="range" id="brightness" min="50" max="150" value="100">
                </div>
                
                <div class="slider-row">
                    <i class="fa-solid fa-circle-half-stroke" title="Contrast"></i>
                    <input type="range" id="contrast" min="50" max="150" value="100">
                </div>
            </div>

            <button class="btn-action btn-download" onclick="downloadCard()">
                <i class="fa-solid fa-download"></i> Download HD Image
            </button>
            <button class="btn-action btn-print" onclick="printCard()">
                <i class="fa-solid fa-print"></i> Print Card
            </button>

        </div>

        <div class="preview-area">
            <span class="label" style="margin-bottom:15px;">Live Preview</span>
            <img id="liveImg" src="https://via.placeholder.com/400x250?text=Upload+Card+Image" alt="Preview">
            <div class="dimensions-badge">Size: 85.6mm x 53.98mm (Standard ID-1)</div>
        </div>

    </div>
</div>

<canvas id="processCanvas"></canvas>

<script>
    // Elements
    const fileInput = document.getElementById('fileInput');
    const liveImg = document.getElementById('liveImg');
    const brightnessInput = document.getElementById('brightness');
    const contrastInput = document.getElementById('contrast');
    const canvas = document.getElementById('processCanvas');
    const ctx = canvas.getContext('2d');

    // Standard CR80 Dimensions @ 300 DPI
    // 85.60mm x 53.98mm -> Approx 1011px x 638px
    const cardWidth = 1011;
    const cardHeight = 638;

    let originalImage = new Image();
    let isImageLoaded = false;

    // 1. Handle File Upload
    fileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if(!file) return;

        const url = URL.createObjectURL(file);
        originalImage.src = url;
        
        originalImage.onload = () => {
            isImageLoaded = true;
            renderPreview();
        };
    });

    // 2. Handle Filters (Live Preview only CSS)
    [brightnessInput, contrastInput].forEach(input => {
        input.addEventListener('input', () => {
            if(isImageLoaded) {
                // Apply CSS filter to preview image for speed
                liveImg.style.filter = `brightness(${brightnessInput.value}%) contrast(${contrastInput.value}%)`;
            }
        });
    });

    // 3. Render Logic
    function renderPreview() {
        liveImg.src = originalImage.src;
        // Reset filters visually
        liveImg.style.filter = `brightness(${brightnessInput.value}%) contrast(${contrastInput.value}%)`;
    }

    // 4. Process Image on Canvas (For Download/Print)
    function processImage() {
        if(!isImageLoaded) {
            alert("Please upload an image first!");
            return false;
        }

        // Set High Res Dimensions
        canvas.width = cardWidth;
        canvas.height = cardHeight;

        // Apply Filters via Context
        const b = brightnessInput.value;
        const c = contrastInput.value;
        ctx.filter = `brightness(${b}%) contrast(${c}%)`;

        // Draw Image (Stretch to fit CR80 size)
        ctx.drawImage(originalImage, 0, 0, cardWidth, cardHeight);
        return true;
    }

    // 5. Download Function
    function downloadCard() {
        if(processImage()) {
            const link = document.createElement('a');
            link.download = 'smart-card-print.png';
            link.href = canvas.toDataURL('image/png', 1.0);
            link.click();
        }
    }

    // 6. Print Function
    function printCard() {
        if(processImage()) {
            const dataUrl = canvas.toDataURL('image/png', 1.0);
            const win = window.open('', '_blank');
            win.document.write(`
                <html>
                <head>
                    <title>Print Card</title>
                    <style>
                        body { margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; }
                        img { width: 85.6mm; height: 53.98mm; border: 1px dashed #ccc; }
                        @media print {
                            body { margin: 0; }
                            img { border: none; }
                        }
                    </style>
                </head>
                <body>
                    <img src="${dataUrl}" onload="window.print();window.close()">
                </body>
                </html>
            `);
            win.document.close();
        }
    }

    // Dropdown Logic (Currently most cards are same size, but placeholders added for future logic)
    function updateSettings() {
        // In future, if specific cards have different ratios, adjust here.
        // For now, all Indian Smart Cards follow ISO 7810 ID-1.
        console.log("Card Type Selected: " + document.getElementById('cardType').value);
    }

</script>

</body>
</html>
